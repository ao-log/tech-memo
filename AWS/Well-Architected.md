# AWS による優れた設計のフレームワーク

こちらの資料を読んで、参考になった点をメモとして残しておく。

[AWS による優れた設計のフレームワーク](https://media.amazonwebservices.com/jp/wp/Well-Architected_Whitepaper_v2_JP.pdf)

## 全体

> AWS による優れた設計のフレームワークは、セキュリティ、信頼性、
パフォーマンス効率、コスト最適化、運⽤性という 5 本の柱を基本としていま
す。

信頼性、パフォーマンス効率、コスト最適化はトレードオフ。セキュリティ、運用性はトレードオフにならない。

## クラウドの利点

* 自動的にスケールできる。
* テスト環境の作成が用意。課金も使っている間だけ。
* 構成変更の自動化。監査ログを残したり、切り戻しも容易。
* バージョンアップが容易。オンデマンドな変更ができるため。

## セキュリティの柱

### 設計の原則

* 全てのレイヤでセキュリティを適用（エッジ、入り口だけでなく、ロードバランサ、各サーバ、サブネットそれぞれにおいて）
* トレーサビリティの有効化
* IAM による権限制御
* AWS 責任共有モデル

### ベストプラクティスの領域

#### アイデンティティ管理とアクセス管理

* ルートアカウントの使用を保護すること
* IAM をユーザごとに適切に設定すること
* 他要素認証の有効化

#### 発⾒的統制

* ログ（API 呼び出しや構成変更履歴）を蓄積し、事象を検知できること

#### インフラストラクチャの保護

* ネットワーク、ホストレベル境界の保護を適切に行うこと
* 業界、法令上の義務に従うこと

#### データ保護

* データを機密度に応じて分類し、機密レベルが高いものは暗号化によって保護すること
* キーのローテーションを定期的に行うこと
* アクセスログを採取すること
* データをバージョニングすることで、意図しない上書きからデータを保護すること
* 伝送中のデータを暗号化すること

#### インシデントへの対応

* 定期的にチェックし、アーキテクチャを強固なものへと改善すること
* インシデント対応時には影響範囲の最小化や、復旧など、適切な対応を迅速に撮れること

## 信頼性の柱

### 設計の原則

#### 復旧手順のテスト

検証環境で障害のシミュレートや以前起きた障害の環境を再作成できる。そのため、復旧手順をテストしたり、障害原因を特定して改修するプロセスを行いやすい。

#### 障害から自動で復旧

KPI をモニタリングし、閾値を超えた場合に自動処理をトリガーさせることができる。

#### 水平スケールによる可用性向上

単一障害点を無くすことができる。

#### キャパシティの予測が不要に

オートスケールによりキャパシティへの対応を自動化できる。

### ベストプラクティスの領域

#### 基礎

* 非機能要件の定義が重要。アカウントにはリソース制限があることも考慮する必要あり

#### 変更管理

* 変更は自動で行うようにする
* 変更はログに残るようにする。
* モニタリングを行い、KPI が想定外の値となった場合は、アラートを発して検知できるようにする

#### 障害管理

目標は、システム復旧プロセスを徹底的にテストし、問題が解決できない局⾯においても、すべてのデータが復旧可能で顧客へのサービスを継続できる確信を持ち続けること。

* 復旧のプロセスが確立されているかどうか
* 障害から復旧のテストを定期的に自動化して行っているかどうか
* データは復元可能か（どのようにバックアップするか）
* 災害対策を考慮できているか

## パフォーマンス効率の柱

### 設計の原則

* NoSQL、機械学習など最先端技術をサービスとして利用できる
* マルチリージョンを容易に実現できる
* テストの容易性（環境を簡単に作れる）
* 実現したいことに最も適したテクノロジーを選定すること

### ベストプラクティスの領域

#### サービスの選定

* 最良のアーキテクチャを選定できているかどうか
  * コンピューティングリソース
  * ストレージ（アクセス方法、アクセス頻度、更新頻度、サービスの可用性・耐久性）
  * データベース（可用性、整合性、レイテンシ、耐久性、拡張性、クエリ要件）
  * ネットワーク（エッジロケーション、VPCエンドポイント、DirectConnect、Route53レイテンシルーティング）
* モニタリング
* レプリカ、キャッシュ

## コスト最適化の柱

ビジネス上の成果を達成しコストを最小限に抑えるコスト意識の⾼いシステムを構築して運⽤することができ、投資収益率を最⼤化

### 設計の原則

* 従量課金のため、未使用時は停止する
* クラウド事業者のスケールメリットに乗っかる
* データセンタ投資が不要に
* 使用量とコストの正確な把握
* マネージドサービスの活用

### ベストプラクティスの領域

#### コスト効果が高いリソース

* トータルコストが安くなるようにリソースを選定する
* リザーブドインスタンス、スポットインスタンスの活用

#### 需要と供給の一致

* オートスケール

#### 費用の把握

* データ転送料金など抜け漏れなく考慮できているか
* 使用状況、使用量のモニタリング方法を確立しておく
* 不要リソースは停止する
* AWS 使用状況を管理する
* コストタグを使うことで、用途ごとに分類して集計可能
* 費用超過時にアラートを出す

#### 継続した最適化

* 新しいサービスがリリースされた時に、置き換えた方がよくないか検討

## 運用性の柱

### 設計の原則

* 反復作業は自動化。コードによるオペレーションの実行
* オペレーションプロセスをビジネスと合わせる。不要なメトリクスは採取不要
* 定期的に小規模で増分を加える
* 運用イベント、障害の情報を蓄積し、改善に活かせるようにする
* オペレーション手順を最新に保つ

## ベストプラクティスの領域

### 準備

* 運用チェックリストを用意すること
  * 日常的なタスクを実行できるようにすること（ランブック）
  * 予期しない運用イベントに対応できるようにすること（プレイブック）
    * 応答プラン、エスカレーションパス、ステークホルダ通知
  * ドキュメントを最新に保つこと（アプリケーション設計、環境設定、リソース設定、対応プラン・軽微プラン）

### 運用

* 標準化され、日常的に管理できること
* 変更は大規模、低頻度にならないようにすること
* 運用指標に基づくメトリクス、ログの収集
* ルーチン作業の自動化

### 応答

* イベント応答への対応の自動化
* 応答は、ステークホルダー、エスカレーションプロセス
および手順を含む事前定義されたプレイブックに従う必要がある



# Documents

[AWS Well-Architected](https://aws.amazon.com/jp/architecture/well-architected)

[AWS Well-Architected Framework - Documentation](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/framework/welcome.html)

[運用上の優秀性の柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/operational-excellence-pillar/welcome.html)

[セキュリティの柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/security-pillar/welcome.html)

[信頼性の柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/reliability-pillar/welcome.html)

[パフォーマンス効率の柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/performance-efficiency-pillar/welcome.html)

[コスト最適化の柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/cost-optimization-pillar/welcome.html)

[持続可能性の柱](https://docs.aws.amazon.com/ja_jp/wellarchitected/latest/sustainability-pillar/sustainability-pillar.html)



# BlackBelt

[AWS Well-Architected Framework](https://pages.awscloud.com/rs/112-TZM-766/images/20181211_AWS-BlackBelt-Well-Architected.pdf)

[AWS Well-Architected Frameworkによるコスト最適化](https://pages.awscloud.com/rs/112-TZM-766/images/20190312_AWS-BlackBelt_Cost_Optimazed_with_WA.pdf)


