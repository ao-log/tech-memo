
# マシンタイプ

* 事前定義されたマシンタイプ
  * 標準マシンタイプ
  * ハイメモリマシンタイプ
  * ハイ CPU マシンタイプ
  * 共有コアマシンタイプ
  * メモリ最適化マシンタイプ
* カスタムマシンタイプ

単一テナントノードにすることも可能。

https://cloud.google.com/compute/docs/machine-types?hl=ja

### プリエンプティブ VM

https://cloud.google.com/compute/docs/instances/create-start-preemptible-instance?hl=ja

### GPU

追加できるのは、ある特定のゾーンに作成できる事前定義されたマシンタイプまたはカスタムマシンタイプのインスタンスのみ。

### ストレージオプション

* ゾーン標準永続ディスクとゾーン SSD 永続ディスク
  * データは、複数の物理ディスクに分散される
  * バックアップされる
  * 暗号化される (ユーザ指定の鍵も可能)
* リージョン永続ディスクとリージョン SSD 永続ディスク
  * ゾーンが停止した場合でも、force-attach コマンドを使用して、リージョン永続ディスク上で実行されているワークロードを別のゾーンにフェイルオーバーできる
* ローカル SSD
  * ローカルなのでパフォーマンスは高いが、耐障害性は無い。
* Google Cloud Storage バケット
  * ファイルシステムとしてマウントできる

### イメージ ファミリー

関連するイメージをグループ化して、特定のイメージバージョン間でのロールフォワードとロールバックを容易にできる。

### インスタンステンプレート

インスタンス テンプレートは、マシンタイプ、イメージ、ゾーン、ラベル、その他のインスタンス プロパティを定義。

### マネージド インスタンス グループ

* 適用可能な自動スケーリングのポリシーには、CPU 使用率、負荷分散容量、Stackdriver Monitoring の指標や、Google Cloud Pub/Sub などのキューベース ワークロードに基づくスケーリングなど
* 負荷分散
  * グローバルな外部負荷分散
    * HTTP(S) 負荷分散: ユーザー、リクエスト URL、またはその両方の近接性に基づいて、インスタンスのグループ間で HTTPS トラフィックを分散。
    * SSL プロキシ負荷分散: ユーザーの近接性に基づいて、インスタンスのグループ間で SSL トラフィックを分散。
    * TCP プロキシ負荷分散: ユーザーの近接性に基づいて、インスタンスのグループ間で TCP トラフィックを分散。
  * リージョン外部負荷分散
    * リージョン内のインスタンスのプール間でトラフィックを分散
  * 内部負荷分散
    * Google Cloud Platform 仮想マシンインスタンスを同じリージョン内のインスタンスのグループにトラフィックを分散

### 起動スクリプト

https://cloud.google.com/compute/docs/startupscript?hl=ja

### 仮想マシン起動イメージの作成

次のソースからディスク イメージを作成可能

* 永続ディスク。ディスクがインスタンスに接続されていても構いません。
* 永続ディスクのスナップショット
* プロジェクトの別のイメージ
* 別のプロジェクトで共有されているイメージ
* Google Cloud Storage 内の圧縮された RAW イメージ

https://cloud.google.com/compute/docs/images/create-delete-deprecate-private-images?hl=ja

### ゾーン間のインスタンスの移動

1. 永続ディスクのスナップショットを取得
1. そのスナップショットを使用して移動先のゾーンで新しいインスタンスを起動

https://cloud.google.com/compute/docs/instances/moving-instance-across-zones?hl=ja

### スナップショット

ディスクを保存。スナップショットから復元することもできる。
初めはフルで作成。以降は増分。

https://cloud.google.com/compute/docs/disks/create-snapshots?hl=ja

### グローバル リソース、リージョン リソース、ゾーンリソース

・グローバルリソース

* イメージ
* スナップショット
* インスタンステンプレート
* VPC ネットワーク
* ファイアウォール
* ルート
* グローバルオペレーション

・リージョンリソース

* アドレス
* サブネット
* リージョンマネージドインスタンスグループ
* リージョン永続ディスク
* リージョンオペレーション

・ゾーンリソース

* インスタンス
* 永続ディスク
* マシンタイプ
* ゾーンマネージドインスタンスグループ
* ゾーンオペレーション

https://cloud.google.com/compute/docs/regions-zones/global-regional-zonal-resources?hl=ja

### ベストプラクティス
